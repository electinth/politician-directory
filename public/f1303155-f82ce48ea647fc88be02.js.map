{"version":3,"sources":["webpack://politician-directory/./src/components/viz/scoreViz.js"],"names":["cssTimeLine","display","media","width","cssCloseBtn","zIndex","position","top","right","height","cursor","opacity","content","backgroundColor","transform","cssTimeLineCon","cssLollipopCon","overflowX","background","marginTop","overflowY","borderRadius","cssLabel","textAlign","fontSize","marginBottom","left","cssLabelCon","pointerEvents","cssScoreText","cssTooltipStyle","boxShadow","padding","p","a","textDecoration","color","cssLineCon","alignItems","margin","cssLine","typeColor","d3","domain","range","prepareData","senateVoteData","meanScore","map","d","score","reduce","acc","cur","length","criteriaScore","fGrade","filter","senator","dGrade","cGrade","bGrade","labelGradeData","grade","posScore","findIndex","Math","floor","meanPos","id","CreateLabel","gradeObj","css","props","placeholder","useStaticQuery","timelineRef","useRef","lollipopRef","useState","tooltip","setTooltip","tooltipStyle","setTooltipStyle","useEffect","data","placeholderImage","miniWidth","current","clientWidth","mainWidth","mainMargin","maxWidth","brushWidth","brush","extent","on","newXcor","style","timelineSvg","append","attr","xTimeline","call","move","yTimeline","selectAll","enter","bandwidth","senator_method","forEach","pos","lolliSvg","topSection","gBrush","selection","node","size","x0","x1","dx","xLolli","paddingInner","paddingOuter","tickSizeOuter","tickSizeInner","tickFormat","_","i","yLolli","text","toFixed","strokeType","strokeWidth","name","lastname","replace","this","childImageSharp","gatsbyImageData","tooltipTop","tooltipLeft","window","innerWidth","overflow","createChart","updateChart","setScrolling","scrollTop","setScrollTop","onScroll","currentPosition","pageYOffset","addEventListener","title","votelog","href","target","rel","stroke","y1","x2","y2","ref","className","index","key"],"mappings":"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","file":"f1303155-f82ce48ea647fc88be02.js","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\"\nimport { media } from \"../../styles\"\nimport * as d3 from \"d3\"\nimport { useStaticQuery, graphql } from \"gatsby\"\nimport _ from \"lodash\"\n\nconst cssTimeLine = {\n  display: \"none\",\n  [media(767)]: {\n    width: \"100%\",\n    display: \"flex\",\n  },\n}\n\nconst cssCloseBtn = {\n  zIndex: \"100\",\n  position: \"absolute\",\n  top: \"0.5rem\",\n  right: \"0.5rem\",\n  width: \"10px\",\n  height: \"10px\",\n  cursor: \"pointer\",\n  opacity: \"0.5\",\n  [media(767)]: {\n    right: \"0.5rem\",\n  },\n  \"&:hover\": {\n    opacity: \"1\",\n  },\n  \"&:before, &:after\": {\n    position: \"absolute\",\n    top: \"0\",\n    right: \"1.2rem\",\n    content: '\"\"',\n    height: \"12px\",\n    width: \"1px\",\n    backgroundColor: \"black\",\n  },\n  \"&:before\": {\n    transform: \"rotate(45deg)\",\n  },\n  \"&:after\": {\n    transform: \"rotate(-45deg)\",\n  },\n}\n\nconst cssTimeLineCon = {\n  display: \"none\",\n  [media(767)]: {\n    width: \"100%\",\n    display: \"flex\",\n    position: \"relative\",\n  },\n}\n\nconst cssLollipopCon = {\n  overflowX: \"scroll\",\n  background: \"rgba(238,240,144, 0.1)\",\n  [media(767)]: {\n    height: \"43.6rem\",\n    marginTop: \"2.6rem\",\n    overflowY: \"hidden\",\n    position: \"relative\",\n  },\n  \"::-webkit-scrollbar-track\": {\n    background: \"#DFDFDF\",\n  },\n  \"::-webkit-scrollbar\": {\n    height: 7,\n    background: \"#DFDFDF\",\n  },\n  \"::-webkit-scrollbar-thumb\": {\n    background: \"#F0324B\",\n    borderRadius: 6,\n  },\n}\n\nconst cssLabel = {\n  width: \"7.6rem\",\n  height: \"2.4rem\",\n  borderRadius: \"0.3rem\",\n  position: \"relative\",\n  background: \"#EEF090\",\n  textAlign: \"center\",\n  fontSize: \"1.4rem\",\n  marginBottom: \"0.8rem\",\n  zIndex: 9,\n  left: 0,\n}\n\nconst cssLabelCon = {\n  height: \"39.4rem\",\n  width: \"24rem\",\n  position: \"sticky\",\n  marginTop: \"-34rem\",\n  left: 0,\n  zIndex: 150,\n  pointerEvents: \"none\",\n}\n\nconst cssScoreText = {\n  fontSize: \"1.2rem\",\n}\n\nconst cssTooltipStyle = {\n  position: \"fixed\",\n  width: \"20.6rem\",\n  background: \"#fff\",\n  boxShadow: \"0px 1px 4px rgba(0, 0, 0, 0.25)\",\n  borderRadius: \"0.4rem\",\n  padding: \"1.2rem\",\n  zIndex: 99999,\n  p: {\n    fontSize: \"1.2rem\",\n    marginBottom: \"0.4rem\",\n  },\n  a: {\n    textDecoration: \"underline\",\n    fontSize: \"1rem\",\n    color: \"#999C00\",\n  },\n}\n\nconst cssLineCon = {\n  position: \"sticky\",\n  width: \"100%\",\n  left: 0,\n  display: \"flex\",\n  alignItems: \"center\",\n  p: {\n    fontSize: \"1rem\",\n    margin: 0,\n    padding: 0,\n  },\n  zIndex: \"100\",\n}\n\nconst cssLine = {\n  width: \"100%\",\n  height: \"0.1rem\",\n}\n\nconst type = [\"โดยตำแหน่ง\", \"เลือกโดย คสช.\", \"เลือกกันเอง\"]\nconst typeColor = d3\n  .scaleOrdinal()\n  .domain(type)\n  .range([\"#999C00\", \"#5739AC\", \"#FEACAC\"])\n\nfunction prepareData(senateVoteData) {\n  const meanScore =\n    senateVoteData.map(d => d.score).reduce((acc, cur) => acc + cur, 0) /\n    senateVoteData.length\n  const criteriaScore = [50, 60, 70, 80]\n  const fGrade = senateVoteData.filter(senator => senator.score < 50).length\n  const dGrade = senateVoteData.filter(\n    senator => senator.score > 50 && senator.score < 60\n  ).length\n  const cGrade = senateVoteData.filter(\n    senator => senator.score > 60 && senator.score < 70\n  ).length\n  const bGrade = senateVoteData.filter(\n    senator => senator.score > 70 && senator.score < 80\n  ).length\n  const aGrade = senateVoteData.filter(senator => senator.score > 80).length\n  const labelGradeData = [\n    { grade: \"A\", score: aGrade },\n    { grade: \"B\", score: bGrade },\n    { grade: \"C\", score: cGrade },\n    { grade: \"D\", score: dGrade },\n    { grade: \"F\", score: fGrade },\n  ]\n  const posScore = criteriaScore.map(score => {\n    return senateVoteData.findIndex(d => Math.floor(d.score) === score)\n  })\n  const meanPos = senateVoteData.filter(\n    d => Math.floor(d.score) === Math.floor(meanScore)\n  )[0].id\n  return {\n    criteriaScore,\n    posScore,\n    meanPos,\n    labelGradeData,\n  }\n}\n\nfunction createChart(\n  data,\n  timelineRef,\n  lollipopRef,\n  setTooltip,\n  setTooltipStyle,\n  placeholder\n) {\n  const { criteriaScore, posScore, meanPos } = prepareData(data)\n  const placeholderImage = _.get(\n    placeholder,\n    \"placeholderImage.childImageSharp.fluid.src\"\n  )\n  const miniHeight = 88\n  const miniWidth = timelineRef.current.clientWidth\n\n  const mainHeight = 394\n  const mainWidth = lollipopRef.current.clientWidth\n  const mainMargin = {\n    left: 20,\n    right: 20,\n    bottom: 16,\n    top: 34,\n  }\n  const maxWidth = 12000\n\n  const brushWidth = (mainWidth / maxWidth) * miniWidth\n\n  function brushmove() {\n    const extentX = d3.event.selection\n    const newXcor = -extentX[0] * (maxWidth / mainWidth)\n    d3.select(lollipopRef.current).style(\n      \"transform\",\n      `translate(${newXcor}px,0px)`\n    )\n  }\n\n  function scroll() {\n    const gBrush = d3.select(\".brush\")\n    let selection = d3.brushSelection(gBrush.node())\n    let size = selection[1] - selection[0],\n      range = xTimeline.range(),\n      x0 = d3.min(range),\n      x1 = d3.max(range),\n      dx = -d3.event.deltaX,\n      topSection\n\n    if (selection[0] - dx < x0) {\n      topSection = x0\n    } else if (selection[1] - dx > x1) {\n      topSection = x1 - size\n    } else {\n      topSection = selection[0] - dx\n    }\n    d3.event.stopPropagation()\n    d3.event.preventDefault()\n    gBrush.call(brush.move, [topSection, topSection + size])\n  }\n\n  const brush = d3\n    .brushX()\n    .extent([\n      [0, 0],\n      [miniWidth, miniHeight],\n    ])\n    .on(\"brush\", brushmove)\n\n  const timelineSvg = d3\n    .select(timelineRef.current)\n    .append(\"svg\")\n    .attr(\"width\", miniWidth)\n    .attr(\"height\", miniHeight)\n    .style(\"pointer-events\", \"none\")\n\n  const xTimeline = d3\n    .scaleBand()\n    .domain(\n      data.map(function(d) {\n        return d.id\n      })\n    )\n    .range([0, miniWidth])\n    .padding(0.2)\n\n  timelineSvg\n    .append(\"g\")\n    .attr(\"class\", \"brush\")\n    .call(brush)\n    .call(brush.move, [0, brushWidth])\n\n  const yTimeline = d3\n    .scaleLinear()\n    .domain([0, 100])\n    .range([miniHeight, 0])\n\n  const miniBar = timelineSvg\n    .selectAll(\"timelineBar\")\n    .data(data)\n    .enter()\n  miniBar\n    .append(\"rect\")\n    .attr(\"class\", \"miniBar\")\n    .attr(\"x\", function(d) {\n      return xTimeline(d.id)\n    })\n    .attr(\"y\", function(d) {\n      return yTimeline(d.score)\n    })\n    .attr(\"width\", xTimeline.bandwidth())\n    .attr(\"height\", function(d) {\n      return miniHeight - yTimeline(d.score)\n    })\n    .attr(\"fill\", function(d) {\n      return typeColor(d.senator_method)\n    })\n\n  d3.selectAll(\".handle\").style(\"pointer-events\", \"none\")\n  d3.select(\".overlay\").style(\"pointer-events\", \"none\")\n\n  // let sumPos = 0\n  posScore.forEach(pos => {\n    if (pos === -1) return\n    timelineSvg\n      .append(\"line\")\n      .attr(\"x1\", xTimeline(data[pos].id))\n      .attr(\"x2\", xTimeline(data[pos].id))\n      .attr(\"y1\", 0)\n      .attr(\"y2\", 88)\n      .attr(\"stroke\", \"#AEAEAE\")\n      .attr(\"stroke-dasharray\", \"4\")\n\n    // const leftPos = sumPos + xTimeline(data[pos].id) / 2\n    // const legend = document.createElement(\"p\")\n    // legend.innerText = \"A\"\n    // legend.style.cssText = `position: absolute; top: 0; left: ${leftPos}px`\n    // document.getElementById(\"timeline-viz\").appendChild(legend)\n    // sumPos += xTimeline(data[pos].id)\n  })\n\n  timelineSvg\n    .append(\"line\")\n    .attr(\"x1\", xTimeline(meanPos))\n    .attr(\"x2\", xTimeline(meanPos))\n    .attr(\"y1\", 0)\n    .attr(\"y2\", 88)\n    .attr(\"stroke\", \"#F0324B\")\n\n  const lolliSvg = d3\n    .select(lollipopRef.current)\n    .append(\"svg\")\n    .attr(\"height\", mainHeight + mainMargin.top)\n    .attr(\"width\", maxWidth)\n    .on(\"wheel.zoom\", scroll)\n\n  const xLolli = d3\n    .scaleBand()\n    .domain(data.map(d => d.id))\n    .range([0, maxWidth])\n    .paddingInner(0.9)\n    .paddingOuter(0.5)\n\n  lolliSvg\n    .append(\"g\")\n    .attr(\"transform\", `translate(0,378)`)\n    .call(\n      d3\n        .axisBottom(xLolli)\n        .tickSizeOuter(0)\n        .tickSizeInner(0)\n        .tickFormat(function(_, i) {\n          return i + 1\n        })\n    )\n\n  const yLolli = d3\n    .scaleLinear()\n    .domain([0, 100])\n    .range([mainHeight, mainMargin.top + 40])\n\n  lolliSvg\n    .selectAll(\"group\")\n    .data(data)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"group\")\n    .append(\"rect\")\n    .attr(\"class\", \"lolliBar\")\n    .attr(\"x\", function(d) {\n      return xLolli(d.id)\n    })\n    .attr(\"y\", function(d) {\n      return yLolli(d.score) - mainMargin.bottom\n    })\n    .attr(\"width\", xLolli.bandwidth())\n    .attr(\"height\", function(d) {\n      return mainHeight - yLolli(d.score)\n    })\n    .attr(\"fill\", function(d) {\n      return typeColor(d.senator_method)\n    })\n\n  d3.selectAll(\".group\")\n    .append(\"text\")\n    .attr(\"class\", \"percentText\")\n    .attr(\"x\", function(d) {\n      return xLolli(d.id) - 5\n    })\n    .attr(\"y\", function(d) {\n      return yLolli(d.score) - mainMargin.bottom - 20 - 30\n    })\n    .attr(\"fill\", \"#828282\")\n    .attr(\"font-size\", \"1.2rem\")\n    .attr(\"dominant-baseline\", \"middle\")\n    // .attr(\"text-anchor\", \"middle\")\n    .text(function(d) {\n      return `${d.score.toFixed(0)}%`\n    })\n\n  d3.select(\".selection\")\n    .attr(\"fill\", \"#EEF090\")\n    .attr(\"stroke-width\", 1)\n    .attr(\"stroke\", \"rgba(0,0,0,0.2)\")\n    .attr(\"z-index\", 9999999)\n\n  criteriaScore.forEach((score, i) => {\n    const strokeType = score === 100 ? \"stroke-width\" : \"stroke-dasharray\"\n    const strokeWidth = score === 100 ? 1 : 0.5\n    lolliSvg\n      .append(\"line\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", maxWidth)\n      .attr(\"y1\", yLolli(score) - mainMargin.bottom)\n      .attr(\"y2\", yLolli(score) - mainMargin.bottom)\n      .attr(\"stroke\", \"#AEAEAE\")\n      .attr(strokeType, \"2\")\n      .attr(\"stroke-width\", strokeWidth)\n  })\n  d3.selectAll(\".group\")\n    .append(\"svg:defs\")\n    .append(\"svg:pattern\")\n    .attr(\"id\", function(_, i) {\n      return \"profile\" + i\n    })\n    .attr(\"width\", 40)\n    .attr(\"height\", 40)\n    .attr(\"patternUnits\", \"userSpaceOnUse\")\n    .append(\"svg:image\")\n    .attr(\"xlink:href\", function(d) {\n      return `https://elect.thematter.co/data/politicians/${\n        d.name\n      }-${d.lastname.replace(/ /g, \"-\")}.jpg`\n    })\n    .on(\"error\", function(d) {\n      d3.select(this).attr(\"xlink:href\", placeholderImage)\n    })\n    .attr(\"fluid\", placeholder.placeholderImage.childImageSharp.gatsbyImageData)\n    .attr(\"width\", 40)\n    .attr(\"height\", 40)\n    .attr(\"x\", 0)\n    .attr(\"y\", 0)\n\n  d3.selectAll(\".group\")\n    .append(\"circle\")\n    .attr(\"class\", d => `circle${d.id}`)\n    .attr(\"transform\", function(d) {\n      const x = xLolli(d.id) - 20 + xLolli.bandwidth() / 2\n      const y = yLolli(d.score) - mainMargin.bottom - 40\n      return `translate(${x}, ${y})`\n    })\n    .attr(\"cx\", 20)\n    .attr(\"cy\", 20)\n    .attr(\"r\", 20)\n    .style(\"fill\", \"#fff\")\n    .style(\"fill\", function(_, i) {\n      return \"url(#profile\" + i + \")\"\n    })\n    .style(\"cursor\", \"pointer\")\n    .attr(\"stroke\", \"black\")\n    .attr(\"stroke-width\", 1)\n    .on(\"mouseover\", function(d) {\n      d3.selectAll(\"circle\").attr(\"stroke-width\", 1)\n      d3.select(`.circle${d.id}`).attr(\"stroke-width\", 2)\n      const tooltipTop = d3.event.clientY - mainMargin.bottom - 120\n      const tooltipLeft =\n        d3.event.clientX + 250 > window.innerWidth\n          ? d3.event.clientX - 200\n          : d3.event.clientX + 10\n      setTooltip(d)\n      setTooltipStyle({\n        ...cssTooltipStyle,\n        top: tooltipTop,\n        left: tooltipLeft,\n        overflow: \"hidden\",\n        opacity: 1,\n      })\n    })\n    .on(\"click\", function(d) {\n      d3.select(\"#closeBtn\").on(\"click\", function() {\n        d3.select(`.circle${d.id}`).attr(\"stroke-width\", 1)\n        setTooltipStyle({\n          width: 0,\n          height: 0,\n          top: null,\n          left: null,\n          opacity: 0,\n        })\n      })\n    })\n}\n\nfunction updateChart(filter) {\n  if (filter === \"โดยตำแหน่ง\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else if (filter === \"เลือกโดย คสช.\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else if (filter === \"เลือกกันเอง\") {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return filter !== d.senator_method ? \"0.1\" : \"1\"\n    })\n  } else {\n    d3.selectAll(\".group\").style(\"opacity\", function(d) {\n      return \"1\"\n    })\n    d3.selectAll(\".miniBar\").style(\"opacity\", function(d) {\n      return \"1\"\n    })\n  }\n}\n\nfunction CreateLabel({ gradeObj }) {\n  return (\n    <div css={{ ...cssLabel }}>\n      <strong>{gradeObj.grade}</strong>{\" \"}\n      <span css={{ ...cssScoreText }}>{gradeObj.score} คน</span>\n    </div>\n  )\n}\n\nconst ScoreViz = props => {\n  const placeholder = useStaticQuery(graphql`\n    {\n      placeholderImage: file(\n        relativePath: { eq: \"images/people/placeholder.png\" }\n      ) {\n        childImageSharp {\n          gatsbyImageData(width: 84, layout: CONSTRAINED)\n        }\n      }\n    }\n  `)\n  const { senateVoteData, filter } = props\n  const { labelGradeData } = prepareData(senateVoteData)\n  const timelineRef = useRef(null)\n  const lollipopRef = useRef(null)\n\n  const [tooltip, setTooltip] = useState(null)\n  const [tooltipStyle, setTooltipStyle] = useState({\n    position: \"absolute\",\n    width: 0,\n    left: null,\n    top: null,\n    opacity: 0,\n  })\n\n  useEffect(() => {\n    createChart(\n      senateVoteData,\n      timelineRef,\n      lollipopRef,\n      setTooltip,\n      setTooltipStyle,\n      placeholder\n    )\n  }, [])\n\n  useEffect(() => {\n    updateChart(filter)\n  }, [filter])\n\n  const [scrolling, setScrolling] = useState(false)\n  const [scrollTop, setScrollTop] = useState(0)\n  useEffect(() => {\n    function onScroll() {\n      let currentPosition = window.pageYOffset // or use document.documentElement.scrollTop;\n      if (currentPosition > scrollTop) {\n        // downscroll code\n        setScrolling(false)\n      } else {\n        // upscroll code\n        setScrolling(true)\n      }\n      setScrollTop(currentPosition <= 0 ? 0 : currentPosition)\n    }\n\n    setTooltipStyle({\n      position: \"absolute\",\n      width: 0,\n      height: 0,\n      top: null,\n      left: null,\n      opacity: 0,\n    })\n\n    window.addEventListener(\"scroll\", _.throttle(onScroll, 10000))\n    return window.addEventListener(\"scroll\", _.throttle(onScroll, 10000))\n  }, [scrollTop])\n\n  return (\n    <div>\n      {tooltip ? (\n        <div css={{ ...tooltipStyle }}>\n          <div css={{ ...cssCloseBtn }} id=\"closeBtn\" />\n          <strong>\n            <p>\n              {tooltip.title} {tooltip.name} {tooltip.lastname}\n            </p>\n          </strong>\n          <p>ระยะเวลาทำงาน 145 ครั้ง</p>\n          <p>เข้าลงมติ {tooltip.votelog} ครั้ง</p>\n          <a\n            href={`https://theyworkforus.elect.in.th/people/${\n              tooltip.name\n            }-${tooltip.lastname.replace(/ /g, \"-\")}`}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            css={{ display: \"flex\", alignItems: \"center\" }}\n          >\n            ดูโปรไฟล์\n            <svg css={{ width: 10, height: 10, fill: \"none\", marginLeft: 8 }}>\n              <path\n                d=\"M2.49999 1.66663H0.833328V9.16663H8.33333V7.49996\"\n                stroke=\"#999C00\"\n              />\n              <line\n                x1=\"8.68688\"\n                y1=\"1.18693\"\n                x2=\"3.68688\"\n                y2=\"6.18693\"\n                stroke=\"#999C00\"\n              />\n              <path d=\"M5 0.833374H9.16667V5.00004\" stroke=\"#999C00\" />\n            </svg>\n          </a>\n        </div>\n      ) : (\n        <></>\n      )}\n      <div css={{ ...cssTimeLineCon }} id=\"timeline-viz\">\n        <div ref={timelineRef} css={{ ...cssTimeLine }} />\n      </div>\n      <div css={{ ...cssLollipopCon }} className=\"senate_scroll\">\n        <div css={{ ...cssLineCon, top: \"8rem\", pointerEvents: \"none\" }}>\n          <div css={{ ...cssLine, background: \"#AEAEAE\" }} />\n          <p\n            css={{\n              width: \"20rem\",\n              textAlign: \"center\",\n              fontWeight: \"700\",\n              color: \"#AEAEAE\",\n              background: \"rgba(255,255,255,0.8)\",\n              borderRadius: \"0.3rem\",\n            }}\n          >\n            คะแนนเต็ม 100%\n          </p>\n          <div css={{ ...cssLine, background: \"#AEAEAE\" }} />\n        </div>\n        <div css={{ ...cssLineCon, top: \"16rem\", pointerEvents: \"none\" }}>\n          <div css={{ ...cssLine, background: \"#F0324B\" }} />\n          <p\n            css={{\n              width: \"20rem\",\n              textAlign: \"center\",\n              color: \"#F0324B\",\n              fontWeight: \"700\",\n              background: \"rgba(255,255,255,0.8)\",\n              borderRadius: \"0.3rem\",\n            }}\n          >\n            คะแนนเฉลี่ย 75%\n          </p>\n          <div css={{ ...cssLine, background: \"#F0324B\" }} />\n        </div>\n        <div ref={lollipopRef} />\n        <div css={{ ...cssLabelCon }}>\n          {labelGradeData.map((gradeObj, index) => {\n            return <CreateLabel gradeObj={gradeObj} key={index} />\n          })}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ScoreViz\n"],"sourceRoot":""}